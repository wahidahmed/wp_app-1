jQuery(document).ready(function(){var i;function s(t,e,c,z,d){void 0!==t&&"false"!=t&&""!=t||(t=0),void 0!==e&&"false"!=e&&""!=e||(e=0),jQuery.ajax({url:zpShortcodeAJAX.ajaxurl,ifModified:!0,data:{action:"zpRetrieveViaShortcode",instance_id:c.attr("id"),api_user_id:jQuery(".ZP_API_USER_ID",c).text(),item_type:jQuery(".ZP_ITEM_TYPE",c).text(),item_key:z.zpItemkey,itemtype:z.zpItemType,collection_id:z.zpCollectionId,tag_id:z.zpTagId,author:encodeURI(z.zpAuthor).replace("'","%27"),year:z.zpYear,style:z.zpStyle,limit:z.zpLimit,title:z.zpTitle,showimage:z.zpShowImages,showtags:z.zpShowTags,downloadable:z.zpDownloadable,inclusive:z.zpInclusive,shownotes:z.zpShowNotes,showabstracts:z.zpShowAbstracts,citeable:z.zpCiteable,target:z.zpTarget,urlwrap:z.zpURLWrap,highlight:z.zpHighlight,sortby:jQuery(".ZP_SORTBY",c).text(),order:jQuery(".ZP_ORDER",c).text(),update:d,request_start:t,request_last:e,zpShortcode_nonce:zpShortcodeAJAX.zpShortcode_nonce},xhrFields:{withCredentials:!0},success:function(t){var e,o,l,u=jQuery.parseJSON(t);"empty"==u.status?(e=zpShortcodeAJAX.txt_zperror,0==u.data?(u.data=zpShortcodeAJAX.txt_noitemsfound,e=u.data):e+=u.data,console.log("Zotpress: "+e),t="",0<jQuery("#"+u.instance+" .zp-List .zp-Entry").length&&(t=' class="hide"'),jQuery("#"+u.instance+" .zp-List").removeClass("loading").append("<p"+t+">"+e+"</p>")):(jQuery("#"+u.instance+" .zp-SEO-Content").remove(),void 0!==u&&null!=u&&0!=u&&0<u.data.length?(o="",1==z.zpShowNotes&&(l=""),!1===d?jQuery("#"+u.instance+" .zp-List").addClass("used_cache"):!0===d&&(!jQuery("#"+u.instance+" .zp-List").hasClass("updating")&&0<jQuery("#"+u.instance+" .zp-Citation-Notes").length&&jQuery("#"+u.instance+" .zp-Citation-Notes").remove(),jQuery("#"+u.instance+" .zp-List").hasClass("updating")||jQuery("#"+u.instance+" .zp-List").addClass("updating"),z.zpForceNumsCount=1),0!=u.data&&jQuery.each(u.data,function(t,a){var r="",e=jQuery("#"+u.instance+" .zp-List #zp-ID-"+jQuery(".ZP_POSTID",c).text()+"-"+jQuery(".ZP_API_USER_ID",c).text()+"-"+a.key);if(0<e.length&&!1===d&&!jQuery("#"+u.instance+" .zp-List").hasClass("used_cache"))return!1;var n="none";a.data.hasOwnProperty("itemType")&&(n=a.data.itemType);var i="0000",s="0000";a.meta.hasOwnProperty("parsedDate")&&(i=a.meta.parsedDate.substring(0,4),s=a.meta.parsedDate);var p=a.data.title;a.meta.hasOwnProperty("creatorSummary")&&(p=a.meta.creatorSummary.replace(/ /g,"-")),r+="<div id='zp-ID-"+jQuery(".ZP_POSTID",c).text()+"-"+jQuery(".ZP_API_USER_ID",c).text()+"-"+a.key+"'",r+=" data-zp-author-date='"+p+"-"+s+"'",r+=" data-zp-date-author='"+s+"-"+p+"'",r+=" data-zp-date='"+s+"'",r+=" data-zp-year='"+i+"'",r+=" data-zp-itemtype='"+n+"'",r+=" class='zp-Entry zpSearchResultsItem",!0===d&&(r+=" zp_updated"),0<jQuery("#"+u.instance+" .ZP_SHOWIMAGE").text().trim().length&&a.hasOwnProperty("image")?(r+=" zp-HasImage'>\n",r+="<div id='zp-Citation-"+a.key+"' class='zp-Entry-Image hasImage' rel='"+a.key+"'>\n","image"==z.zpURLWrap&&""!=a.data.url&&(r+="<a href='"+a.data.url+"'",z.zpTarget&&(r+=" target='_blank'"),r+=">"),r+="<img class='thumb' src='"+a.image[0]+"' alt='image' />\n","image"==z.zpURLWrap&&""!=a.data.url&&(r+="</a>"),r+="</div>\n"):r+="'>\n",0<jQuery("#"+u.instance+" .ZP_FORCENUM").text().length&&"1"==jQuery("#"+u.instance+" .ZP_FORCENUM").text()&&(/csl-left-margin/i.test(a.bib)||(a.bib=a.bib.replace('<div class="csl-entry">','<div class="csl-entry">'+z.zpForceNumsCount+". "),z.zpForceNumsCount++)),r+=a.bib,1==z.zpShowAbstracts&&a.data.hasOwnProperty("abstractNote")&&0<a.data.abstractNote.length&&(r+="<p class='zp-Abstract'><span class='zp-Abstract-Title'>Abstract:</span> "+a.data.abstractNote+"</p>\n"),1==z.zpShowTags&&a.data.hasOwnProperty("tags")&&0<a.data.tags.length&&(r+="<p class='zp-Zotpress-ShowTags'><span class='title'>Tags:</span> ",jQuery.each(a.data.tags,function(t,e){r+="<span class='tag'>"+e.tag+"</span>",t!=a.data.tags.length-1&&(r+="<span class='separator'>,</span> ")}),r+="</p>\n"),r+="</div>\n",1==z.zpShowNotes&&a.hasOwnProperty("notes")&&(l+=a.notes),0<e.length&&!0===d?e.replaceWith(jQuery(r)):o+=r}),!1===d&&jQuery("#"+u.instance+" .zp-List").append(o),1==z.zpShowNotes&&0<l.length&&(l="<div class='zp-Citation-Notes'>\n<h4>Notes</h4>\n<ol>\n"+l,l+="</ol>\n</div>\x3c!-- .zp-Citation-Notes --\x3e\n\n",jQuery("#"+u.instance).append(l)),0<jQuery("#"+u.instance+" .zp-List .csl-left-margin").length&&0<jQuery(".ZP_STYLE",c).text().trim().length&&"american-antiquity"!=jQuery(".ZP_STYLE",c).text().trim()&&(z.zpForceNumsCount=1,jQuery("#"+u.instance+" .zp-List .csl-left-margin").each(function(t,e){var a=(a=jQuery(e).text()).replace(a.match(/\d+/)[0],z.zpForceNumsCount);jQuery(e).text(a),z.zpForceNumsCount++})),a(c,u,z),0!=u.meta.request_next&&"false"!=u.meta.request_next?s(u.meta.request_next,u.meta.request_last,c,z,d):(jQuery("#"+u.instance+" .zp-List").removeClass("loading"),jQuery("#"+u.instance+" .zp-List").hasClass("updating")?i[z.zpBibIndex]&&0<i[z.zpBibIndex].length&&i[z.zpBibIndex][i[z.zpBibIndex].length-1]!=z.zpCollectionId?(z.zpCollectionId=i[z.zpBibIndex][i[z.zpBibIndex].indexOf(z.zpCollectionId)+1],jQuery("#"+u.instance+" .zp-List").removeClass("updating"),s(0,0,c,z,!1)):a(c,u,z):s(0,0,c,z,!0))):!0===d&&(jQuery("#"+c.attr("id")+" .zp-List").removeClass("loading"),0==jQuery("#"+c.attr("id")+" .zp-List .zp-Entry").length&&jQuery("#"+c.attr("id")+" .zp-List").append("<p>There are no citations to display.</p>\n")))},error:function(t){console.log("Zotpress via WP AJAX Error: ",t)}})}function a(n,t,i){var e,a,r,s,p,o,l=jQuery(".ZP_SORTBY",n).text(),u=jQuery(".ZP_ORDER",n).text();e=t,a="date"==l?"data-zp-date-author":"data-zp-author-date",r=u,-1!==["author","date"].indexOf(l)&&0==jQuery("#"+e.instance+" .zp-List .csl-left-margin").length&&jQuery("#"+e.instance+" .zp-List div.zp-Entry").sort(function(t,e){t=t.getAttribute(a).toLowerCase(),e=e.getAttribute(a).toLowerCase();return e<t?"asc"==r?1:-1:t<e?"asc"==r?-1:1:0}).detach().appendTo("#"+e.instance+" .zp-List"),!1!==i.zpTitle&&(s={},jQuery("#"+t.instance+" .zp-List div.zp-Entry").each(function(t,e){var a=jQuery(e).data("zp-"+i.zpTitle);!1===s.hasOwnProperty(a)&&(s[a]=[]),s[a].push(jQuery(e).attr("id"))}),p=Object.getOwnPropertyNames(s),"itemtype"==i.zpTitle?((o=["book","bookSection","journalArticle","conferencePaper","thesis","report","encyclopediaArticle","newspaperArticle","magazineArticle","presentation","interview","dictionaryEntry","document","manuscript","patent","map","blogPost","webpage","artwork","film","audioRecording","statute","bill","case","hearing","forumPost","letter","email","instantMessage","software","podcast","radioBroadcast","tvBroadcast","videoRecording","attachment","note"]).slice(0).forEach(function(t,e){-1==p.indexOf(t)&&o.splice(o.indexOf(t),1)}),p=o):"asc"==u?p.sort(function(t,e){return t-e}):p.sort(function(t,e){return e-t}),p.forEach(function(a,t){var e,r=a;"itemtype"==i.zpTitle&&(null!==r.match(/[A-Z]/)&&(e=r.match(/[A-Z]/).index,r=r.substr(0,e)+" "+r.substr(e)),r=r.charAt(0).toUpperCase()+r.slice(1)),"0000"==r&&(r="No date"),i.zpTitle,0==jQuery("#"+n.attr("id")+" .zp-List h3[rel='"+a+"']").length&&jQuery("#"+n.attr("id")+" .zp-List").append("<h3 rel='"+a+"'>"+r+"</h3>\n"),("year"==i.zpTitle&&"asc"==u||"itemtype"==i.zpTitle&&"date"==l)&&s[a].reverse(),s[a].forEach(function(t,e){jQuery("#"+n.attr("id")+" #"+t).insertAfter(jQuery("#"+n.attr("id")+" .zp-List h3[rel='"+a+"']"))})}))}0<jQuery(".zp-Zotpress-Bib").length&&(i={},jQuery(".zp-Zotpress-Bib").each(function(t,e){var a,r=jQuery(e),n={zpItemkey:!1};0<jQuery(".ZP_ITEM_KEY",r).text().trim().length&&(n.zpItemkey=jQuery(".ZP_ITEM_KEY",r).text()),n.zpItemType=!1,0<jQuery(".ZP_ITEMTYPE",r).text().trim().length&&(n.zpItemType=jQuery(".ZP_ITEMTYPE",r).text()),n.zpCollectionId=!1,0<jQuery(".ZP_COLLECTION_ID",r).text().trim().length&&(n.zpCollectionId=jQuery(".ZP_COLLECTION_ID",r).text()),n.zpTagId=!1,0<jQuery(".ZP_TAG_ID",r).text().trim().length&&(n.zpTagId=jQuery(".ZP_TAG_ID",r).text()),n.zpAuthor=!1,0<jQuery(".ZP_AUTHOR",r).text().trim().length&&(n.zpAuthor=jQuery(".ZP_AUTHOR",r).text()),n.zpYear=!1,0<jQuery(".ZP_YEAR",r).text().trim().length&&(n.zpYear=jQuery(".ZP_YEAR",r).text()),n.zpStyle=!1,0<jQuery(".ZP_STYLE",r).text().trim().length&&(n.zpStyle=jQuery(".ZP_STYLE",r).text()),n.zpLimit=!1,0<jQuery(".ZP_LIMIT",r).text().trim().length&&(n.zpLimit=jQuery(".ZP_LIMIT",r).text()),n.zpTitle=!1,0<jQuery(".ZP_TITLE",r).text().trim().length&&(n.zpTitle=jQuery(".ZP_TITLE",r).text()),n.zpShowImages=!1,0<jQuery(".ZP_SHOWIMAGE",r).text().trim().length&&(n.zpShowImages=jQuery(".ZP_SHOWIMAGE",r).text().trim()),n.zpShowTags=!1,0<jQuery(".ZP_SHOWTAGS",r).text().trim().length&&(n.zpShowTags=!0),n.zpDownloadable=!1,0<jQuery(".ZP_DOWNLOADABLE",r).text().trim().length&&(n.zpDownloadable=!0),n.zpInclusive=!1,0<jQuery(".ZP_INCLUSIVE",r).text().trim().length&&(n.zpInclusive=!0),n.zpShowNotes=!1,0<jQuery(".ZP_NOTES",r).text().trim().length&&(n.zpShowNotes=!0),n.zpShowAbstracts=!1,0<jQuery(".ZP_ABSTRACT",r).text().trim().length&&(n.zpShowAbstracts=!0),n.zpCiteable=!1,0<jQuery(".ZP_CITEABLE",r).text().trim().length&&(n.zpCiteable=!0),n.zpTarget=!1,0<jQuery(".ZP_TARGET",r).text().trim().length&&(n.zpTarget=!0),n.zpURLWrap=!1,0<jQuery(".ZP_URLWRAP",r).text().trim().length&&(n.zpURLWrap=jQuery(".ZP_URLWRAP",r).text()),n.zpHighlight=!1,0<jQuery(".ZP_HIGHLIGHT",r).text().trim().length&&(n.zpHighlight=jQuery(".ZP_HIGHLIGHT",r).text()),n.zpForceNumsCount=1,n.zpBibIndex=t,n.zpCollectionId&&-1!=n.zpCollectionId.indexOf(",")?(i[t]=n.zpCollectionId.split(","),n.zpCollectionId=i[t][0],s(0,0,r,n,!1)):n.zpTagId&&1==n.zpInclusive&&-1!=n.zpTagId.indexOf(",")?(t=n.zpTagId.split(","),jQuery.each(t,function(t,e){n.zpTagId=e,s(0,0,r,n,!1)})):n.zpAuthor&&-1!=n.zpAuthor.indexOf(",")?(a=n.zpAuthor.split(","),1==n.zpInclusive?jQuery.each(a,function(t,e){n.zpAuthor=e,s(0,0,r,n,!1)}):s(0,0,r,n,!1)):n.zpYear&&-1!=n.zpYear.indexOf(",")?(a=n.zpYear.split(","),jQuery.each(a,function(t,e){n.zpYear=e,s(0,0,r,n,!1)})):s(0,0,r,n,!1)}))});
